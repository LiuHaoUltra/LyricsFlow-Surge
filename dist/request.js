!function(){var e={110:function(e,t,r){"use strict";r.r(t);var n=r("55"),o=r("514");function a(e,t,r,n,o,a,i){try{var u=e[a](i),c=u.value}catch(e){r(e);return}u.done?t(c):Promise.resolve(c).then(n,o)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function u(e){a(i,n,o,u,c,"next",e)}function c(e){a(i,n,o,u,c,"throw",e)}u(void 0)})}}function u(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function c(){return(c=i(function(){var e,t,r,a,i;return u(this,function(u){switch(u.label){case 0:if(!(e=n.env.request.url).includes("/color-lyrics/v2/track/"))return[3,5];u.label=1;case 1:if(u.trys.push([1,4,,5]),r=(t=e.split("/")).indexOf("track"),a="",-1!==r&&t[r+1]&&(a=t[r+1].split("?")[0]),!a)return[3,3];return[4,function(e){return l.apply(this,arguments)}(a)];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:return i=u.sent(),o.logger.error("[Request] Error: ".concat(i)),[3,5];case 5:return n.env.done({}),[2]}})})).apply(this,arguments)}function l(){return(l=i(function(e){var t,r,a,i,c,l,s;return u(this,function(u){switch(u.label){case 0:if(!(r=(t=n.env.request.headers||{}).Authorization||t.authorization))return o.logger.warn("[Request] No Auth Header"),[2];a="https://api.spotify.com/v1/tracks/".concat(e),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,n.env.fetch({url:a,method:"GET",headers:{Authorization:r,Accept:"application/json"}})];case 2:return 200===(i=u.sent()).status&&i.body?(l={trackName:(c="string"==typeof i.body?JSON.parse(i.body):i.body).name,artist:c.artists?c.artists.map(function(e){return e.name}).join(", "):"Unknown",album:c.album?c.album.name:"Unknown",duration:c.duration_ms},n.env.setStorage("".concat("spotify_meta_").concat(e),JSON.stringify(l)),o.logger.info("[Request] Cached metadata: ".concat(l.trackName))):o.logger.warn("[Request] Metadata fetch failed: ".concat(i.status)),[3,4];case 3:return s=u.sent(),o.logger.error("[Request] Fetch Error: ".concat(s)),[3,4];case 4:return[2]}})})).apply(this,arguments)}(function(){return c.apply(this,arguments)})().catch(function(e){n.env.done({})})},55:function(e,t,r){"use strict";function n(e,t,r,n,o,a,i){try{var u=e[a](i),c=u.value}catch(e){r(e);return}u.done?t(c):Promise.resolve(c).then(n,o)}r.r(t),r.d(t,{env:function(){return i}});function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=new(function(){var e,t,r;function i(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i),a(this,"name",void 0),a(this,"isSurge",void 0),this.name=e,this.isSurge="undefined"!=typeof $httpClient}return e=i,t=[{key:"args",get:function(){return"undefined"!=typeof $argument?$argument:""}},{key:"request",get:function(){return"undefined"!=typeof $request?$request:{url:"",headers:{}}}},{key:"fetch",value:function(e){var t,r=this;return(t=function(){var t,n;return function(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}(this,function(o){return(t=(e.method||"GET").toUpperCase(),n={url:e.url,method:t,headers:e.headers||{},body:e.body,timeout:e.timeout?e.timeout/1e3:void 0},r.isSurge)?(e.binary,[2,new Promise(function(e,r){$httpClient[t.toLowerCase()](n,function(t,n,o){t?r(t):e({status:n.status||200,headers:n.headers,body:o})})})]):[2,Promise.resolve({error:"Not in Surge environment"})]})},function(){var e=this,r=arguments;return new Promise(function(o,a){var i=t.apply(e,r);function u(e){n(i,o,a,u,c,"next",e)}function c(e){n(i,o,a,u,c,"throw",e)}u(void 0)})})()}},{key:"setStorage",value:function(e,t){this.isSurge&&$persistentStore.write(t,e)}},{key:"getStorage",value:function(e){return this.isSurge?$persistentStore.read(e):null}},{key:"msg",value:function(e,t,r){this.isSurge?$notification.post(e,t,r):console.log("[MSG] ".concat(e," - ").concat(t,": ").concat(r))}},{key:"done",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isSurge&&$done(e)}}],o(e.prototype,t),r&&o(e,r),i}())("LyricsFlow")},514:function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}r.r(t),r.d(t,{LogLevel:function(){return c},logger:function(){return l}});function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(u=c||(c={}))[u.OFF=0]="OFF",u[u.ERROR=1]="ERROR",u[u.WARN=2]="WARN",u[u.INFO=3]="INFO",u[u.DEBUG=4]="DEBUG";var u,c,l=new(function(){var e,t,r;function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),a(this,"level",void 0),a(this,"prefix",void 0),this.level="string"==typeof e?this.parseLevel(e):e,this.prefix=t}return e=n,t=[{key:"setLevel",value:function(e){this.level=e}},{key:"parseLevel",value:function(e){switch(e.toUpperCase()){case"OFF":return 0;case"ERROR":return 1;case"WARN":return 2;case"INFO":default:return 3;case"DEBUG":return 4}}},{key:"format",value:function(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];var a=new Date().toISOString().split("T")[1].slice(0,-1);return"[".concat(a,"] [").concat(e,"] ").concat(this.prefix).concat(t)}},{key:"error",value:function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this.level>=1&&(t=console).log.apply(t,[this.format("ERROR",e)].concat(i(n)))}},{key:"warn",value:function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this.level>=2&&(t=console).log.apply(t,[this.format("WARN",e)].concat(i(n)))}},{key:"info",value:function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this.level>=3&&(t=console).log.apply(t,[this.format("INFO",e)].concat(i(n)))}},{key:"debug",value:function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this.level>=4&&(t=console).log.apply(t,[this.format("DEBUG",e)].concat(i(n)))}}],o(e.prototype,t),r&&o(e,r),n}())}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r("110")}();
//# sourceMappingURL=request.js.map